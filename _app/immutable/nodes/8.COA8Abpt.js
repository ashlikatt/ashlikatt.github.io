import{s as te,r as ne,e as L,f as T}from"../chunks/scheduler.DrUr7rw5.js";import{S as se,i as re,o as c,s as C,p,f as b,q as $,g as _,u as M,m as h,n as d,d as x,r as m,t as U,b as z,v as D}from"../chunks/index.BfAMNwJz.js";import{P as oe,H as ie}from"../chunks/pageData.CqP318gz.js";import{G as ae,N as fe,R as K,S as R,C as ue}from"../chunks/columns.C_S5v5-e.js";import{H as le}from"../chunks/header.7nK5GaSa.js";import{E as ce}from"../chunks/externalHeaderButton.22lvPTKl.js";import{C as pe}from"../chunks/console.CuIvkw8x.js";import{C as X}from"../chunks/codebox.DPaNkXg4.js";import{B as $e}from"../chunks/button.DdlWDEYd.js";class y extends Error{constructor(e){super("Runtime Error: "+e)}}class l extends Error{constructor(e,t){super("Compile Error: "+e+`
 At: line `+t.y+", column "+t.x)}}class he extends Error{constructor(e,t){super("Unexpected token "+(t.type===u.IDENTIFIER?t.data:t.type)+". Expected: "+e+`.
 At: line `+t.y+", column "+t.x)}}const u={OPEN_ARRAY:0,CLOSE_ARRAY:1,OPEN_BLOCK:2,CLOSE_BLOCK:3,SEMICOLON:4,EQUALS:5,CONST_EQUALS:6,RETURN:7,FOR:8,IDENTIFIER:9};class w{constructor(e,t,n,i){this.type=e,this.data=i,this.x=t,this.y=n}get after(){return this.type===u.CONST_EQUALS||this.type===u.RETURN||this.type===u.FOR?{x:this.x+2,y:this.y}:this.type===u.IDENTIFIER?{x:this.x+this.data.length,y:this.y}:{x:this.x+1,y:this.y}}}class de{constructor(){this.inner=[]}push(e){this.inner.push(e)}next(){const e=this.inner.shift();return this.nextVal=e.after,e}peek(e=0){return this.inner[e]}get length(){return this.inner.length}get x(){return this.nextVal.x}get y(){return this.nextVal.y}}function me(s){const e=new de;let t=0,n=0,i=1;for(;t<s.length;){const r=s[t];if(r==="/"&&s[t+1]==="/"){for(;t<s.length&&s[t]!==`
`;)t++;n=0;continue}else if(r==="[")e.push(new w(u.OPEN_ARRAY,n,i));else if(r==="]")e.push(new w(u.CLOSE_ARRAY,n,i));else if(r==="{")e.push(new w(u.OPEN_BLOCK,n,i));else if(r==="}")e.push(new w(u.CLOSE_BLOCK,n,i));else if(r===";")e.push(new w(u.SEMICOLON,n,i));else if(Q(r)){let o="";for(;t<s.length&&Q(s[t]);)o+=s[t++],n++;o==="="?e.push(new w(u.EQUALS,n,i)):o===":="?e.push(new w(u.CONST_EQUALS,n,i)):o==="=>"?e.push(new w(u.FOR,n,i)):o==="->"?e.push(new w(u.RETURN,n,i)):e.push(new w(u.IDENTIFIER,n,i,o));continue}else(r===`
`||r==="\r")&&(i++,n=-1);n++,t++}return e}function Q(s){return s!=="["&&s!=="]"&&s!=="{"&&s!=="}"&&s!==";"&&!ge(s)}function ge(s){return s===" "||s===`
`||s==="\r"}class q{constructor(e,t,n,i,r){this.name=n,this.param=i,this.statement=r,this.x=e,this.y=t}}class G{constructor(e,t,n){this.statements=n,this.x=e,this.y=t}}class W{constructor(e,t,n){this.expression=n,this.x=e,this.y=t}}class J{constructor(e,t,n,i,r){this.name=n,this.expression=i,this.codeblock=r,this.x=e,this.y=t}}class B{constructor(e,t,n,i){this.name=n,this.value=i,this.x=e,this.y=t}}class N{constructor(e,t,n,i){this.name=n,this.value=i,this.x=e,this.y=t}}class j{constructor(e,t,n){this.name=n,this.x=e,this.y=t}}class Z{constructor(e,t,n){this.arr=n,this.x=e,this.y=t}}class V{constructor(e,t,n,i){this.name=n,this.expression=i,this.x=e,this.y=t}}function we(s){const e=[];for(;s.length>0;){const t=_e(s);e.push(t)}return e}function E(s){if(s.length<1)throw new l("Expected expression, found none.",s);const e=s.next();if(e.type===u.IDENTIFIER)if(s.length>=1&&(s.peek().type===u.IDENTIFIER||s.peek().type===u.OPEN_ARRAY)){const t=E(s);return new V(e.x,e.y,e.data,t)}else return new j(e.x,e.y,e.data);else if(e.type===u.OPEN_ARRAY){const t=[];if(s.length<1)throw new l("Unclosed array.",s);if(s.peek().type!==u.CLOSE_ARRAY){for(t.push(E(s));s.length>0&&s.peek().type!==u.CLOSE_ARRAY;)v(s),t.push(E(s));if(s.length===0)throw new l("Unclosed array.",s)}return s.next(),new Z(e.x,e.y,t)}else throw new l("Unexpected expression. Expected variable, function call, or array literal.",e)}function S(s){if(s.length<1)throw new l("Expected statement, found none.",s);if(s.length>=2&&s.peek(0).type===u.IDENTIFIER&&(s.peek(1).type===u.IDENTIFIER||s.peek(1).type===u.OPEN_ARRAY)){const t=E(s);return v(s),t}const e=s.next();if(e.type===u.IDENTIFIER){if(s.length<1)throw new l("Expected =, :=, or =>, found none.",e.after);const t=s.next();if(t.type===u.EQUALS){if(s.length<1)throw new l("Expected expression, found none.",t.after);const n=E(s);return v(s),new B(e.x,e.y,e.data,n)}else if(t.type===u.CONST_EQUALS){if(s.length<1)throw new l("Expected expression, found none.",t.after);const n=E(s);if(s.length<1)throw new l("Expected => or ;, found none.",s);const i=s.next();if(i.type===u.SEMICOLON)return new N(e.x,e.y,e.data,n);if(i.type===u.FOR){const r=S(s);return new J(e.x,e.y,e.data,n,r)}else throw new l("Unexpected token, expected => or ;.",i)}else throw new l("Unexpected token, expected = or :=.",t)}else if(e.type===u.RETURN){if(s.length<1)throw new l("Expected expression, found none.",e.after);const t=E(s);return v(s),new W(e.x,e.y,t)}else if(e.type===u.OPEN_BLOCK){const t=[];for(;s.length>0&&s.peek().type!==u.CLOSE_BLOCK;)t.push(S(s));if(s.length===0)throw new l("Unclosed codeblock.",s);return s.next(),new G(e.x,e.y,t)}else throw new l("Unexpected token, expected statement.",e)}function _e(s){if(s.length<1)throw new l("Expected identifier, found none.",s);const e=s.next();if(s.length<2)throw new l("Expected identifier or assignment, found none.",s);const t=s.next();if(e.type!==u.IDENTIFIER)throw new l("Unexpected token, expected identifier.",e);if(t.type===u.EQUALS){if(s.length<1)throw new l("Expected expression.",s);const n=E(s);return v(s),new B(e.x,e.y,e.data,n)}else if(t.type===u.CONST_EQUALS){if(s.length<1)throw new l("Expected expression.",s);const n=E(s);return v(s),new N(e.x,e.y,e.data,n)}else if(t.type===u.IDENTIFIER){const n=S(s);return new q(e.x,e.y,e.data,t.data,n)}else throw new l("Expected =, :=, or identifier.",s)}function v(s){if(s.length<1)throw new l("Expected semicolon.",s);const e=s.next();if(e.type!==u.SEMICOLON)throw new l("Unexpected token, expected semicolon.",e)}function H(){return{"io.next":(s,e)=>s.inputBuffer.length>0?s.inputBuffer.shift():[],"io.bits":(s,e)=>s.inputBuffer,"io.out":(s,e)=>{if(s.outputBuffer+=e.length>0?"1":"0",s.outputBuffer.length===16){const t=parseInt(s.outputBuffer,2);s.outputBuffer="",A(String.fromCharCode(t))}},"io.debug":(s,e)=>{A(JSON.stringify(e).replaceAll(",",";"))}}}class O{constructor(e){this.vars={},this.constants={},this.outer=e}setVar(e,t){this.outer&&this.outer.hasVar(e)?this.outer.setVar(e,t):this.vars[e]=t}setConst(e,t){if(this.constants[e])throw new y("Attempting to overwrite local constant "+e+".");if(this.hasVar(e))throw new y("Creating constant with same name as var "+e+".");this.constants[e]=t}get(e){if(this.vars[e])return this.vars[e];if(this.constants[e])return this.constants[e];if(this.outer!==void 0)return this.outer.get(e);throw new y(e+" is not a valid variable / constant.")}hasVar(e){var t;return((t=this.outer)==null?void 0:t.hasVar(e))||this.vars[e]}evaluate(e,t){if(t.setError(e),e instanceof Z)return e.arr.map(n=>this.evaluate(n,t));if(e instanceof V)return t.callFunction(e.name,this.evaluate(e.expression,t));if(e instanceof j){const n=this.get(e.name);if(n===void 0)throw new y("Variable/Constant "+e.name+" is not defined.");return n}throw new y(""+e+" is not a valid expression.")}}class xe{constructor(e){this.code=e,this.functions={},this.defaultFunctions=H(),this.context=new O(void 0),this.errorX=0,this.errorY=0,this.inputBuffer=[],this.outputBuffer=""}build(){const e=we(me(this.code));this.functions={},this.defaultFunctions=H(),this.context=new O(void 0),this.errorX=0,this.errorY=0,this.inputBuffer=[],this.outputBuffer="";for(const t of e)if(t instanceof B)this.context.setVar(t.name,this.context.evaluate(t.value,this));else if(t instanceof N)this.context.setConst(t.name,this.context.evaluate(t.value,this));else if(t instanceof q){if(this.functions[t.name])throw new l("Duplicate function "+t.name,t);if(this.defaultFunctions[t.name])throw new l("Cannot overwrite std function "+t.name,t);this.functions[t.name]=t}}setError(e){this.errorX=e.x,this.errorY=e.y}interpret(e=""){this.inputBuffer=e.split("").map(t=>t.charCodeAt(0).toString(2)).map(t=>t.padStart(Math.ceil(t.length/16)*16,"0").split("")).flat().map(t=>t==="0"?[]:[[]]),this.outputBuffer="",this.functions.main?(this.setError(this.functions.main),this.callFunction("main",e)):A("(No main function)")}callFunction(e,t){if(!this.functions[e])if(this.defaultFunctions[e]){const o=this.defaultFunctions[e](this,t);return o!==void 0?o:[]}else throw new y("Function "+e+" does not exist.");const n=this.functions[e],i=new O(this.context);i.setConst(n.param,t);const r=this.evalCode(n.statement,i);return r!==void 0?r:[]}evalCode(e,t){if(this.setError(e),e instanceof G)for(const n of e.statements){this.setError(n);const i=this.evalCode(n,t);if(i!==void 0)return i}else if(e instanceof B)t.setVar(e.name,t.evaluate(e.value,this));else if(e instanceof N)t.setConst(e.name,t.evaluate(e.value,this));else if(e instanceof J)for(const n of t.evaluate(e.expression,this)){this.setError(e);let i=new O(t);i.setConst(e.name,n),this.setError(e.codeblock);const r=this.evalCode(e.codeblock,i);if(r!==void 0)return r}else{if(e instanceof W)return t.evaluate(e.expression,this);e instanceof V&&this.callFunction(e.name,t.evaluate(e.expression,this))}}}function Ee(s,e){const t=new xe(s);ve();try{t.build(),t.interpret(e)}catch(n){if(n instanceof l||n instanceof he)A(n+"");else if(n instanceof y)A(n+`
 At: line `+t.errorY+", column "+t.errorX+".");else throw n}}var F="",Y,k,I,ee;function ye(s){Y=s}function Ce(s){I=s,k=I.value}function be(s){ee=s}function A(s){F+=s,Y.innerHTML=F.replaceAll(`
`,"<br>")}function ve(){F="",Y.innerHTML=""}function Re(){Ee(I.value,ee.value)}function Ie(s){if(I.value!==k){var e="Map data will be erased. Really leave?";return(s||window.event).returnValue=e,e}}function Ae(s){s.ctrlKey&&s.key==="s"&&(s.preventDefault(),Oe("code.forx",I.value))}function Oe(s,e){let t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download",s),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}function Be(s){let e;return{c(){e=U("Back")},l(t){e=z(t,"Back")},m(t,n){_(t,e,n)},d(t){t&&x(e)}}}function Ne(s){let e;return{c(){e=U("Reference")},l(t){e=z(t,"Reference")},m(t,n){_(t,e,n)},d(t){t&&x(e)}}}function Se(s){let e,t,n,i;return e=new ie({props:{href:"langs",$$slots:{default:[Be]},$$scope:{ctx:s}}}),n=new ce({props:{href:"https://esolangs.org/wiki/Foreach",$$slots:{default:[Ne]},$$scope:{ctx:s}}}),{c(){c(e.$$.fragment),t=C(),c(n.$$.fragment)},l(r){p(e.$$.fragment,r),t=b(r),p(n.$$.fragment,r)},m(r,o){$(e,r,o),_(r,t,o),$(n,r,o),i=!0},p(r,o){const a={};o&64&&(a.$$scope={dirty:o,ctx:r}),e.$set(a);const f={};o&64&&(f.$$scope={dirty:o,ctx:r}),n.$set(f)},i(r){i||(h(e.$$.fragment,r),h(n.$$.fragment,r),i=!0)},o(r){d(e.$$.fragment,r),d(n.$$.fragment,r),i=!1},d(r){r&&x(t),m(e,r),m(n,r)}}}function Fe(s){let e,t,n;function i(o){s[3](o)}let r={id:"codebox",init:`// Cat program
main _ {
  a := io.bits[] => {
    io.out a;
  }
}`};return s[0]!==void 0&&(r.element=s[0]),e=new X({props:r}),L.push(()=>D(e,"element",i)),{c(){c(e.$$.fragment)},l(o){p(e.$$.fragment,o)},m(o,a){$(e,o,a),n=!0},p(o,a){const f={};!t&&a&1&&(t=!0,f.element=o[0],T(()=>t=!1)),e.$set(f)},i(o){n||(h(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){m(e,o)}}}function Le(s){let e,t,n;function i(o){s[4](o)}let r={id:"inputbox",init:"Input Here"};return s[2]!==void 0&&(r.element=s[2]),e=new X({props:r}),L.push(()=>D(e,"element",i)),{c(){c(e.$$.fragment)},l(o){p(e.$$.fragment,o)},m(o,a){$(e,o,a),n=!0},p(o,a){const f={};!t&&a&4&&(t=!0,f.element=o[2],T(()=>t=!1)),e.$set(f)},i(o){n||(h(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){m(e,o)}}}function Te(s){let e;return{c(){e=U("Execute")},l(t){e=z(t,"Execute")},m(t,n){_(t,e,n)},d(t){t&&x(e)}}}function Ue(s){let e,t;return e=new $e({props:{click:Re,$$slots:{default:[Te]},$$scope:{ctx:s}}}),{c(){c(e.$$.fragment)},l(n){p(e.$$.fragment,n)},m(n,i){$(e,n,i),t=!0},p(n,i){const r={};i&64&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(h(e.$$.fragment,n),t=!0)},o(n){d(e.$$.fragment,n),t=!1},d(n){m(e,n)}}}function ze(s){let e,t,n,i;return e=new R({props:{size:"2",padded:!0,$$slots:{default:[Le]},$$scope:{ctx:s}}}),n=new R({props:{size:"1",padded:!0,$$slots:{default:[Ue]},$$scope:{ctx:s}}}),{c(){c(e.$$.fragment),t=C(),c(n.$$.fragment)},l(r){p(e.$$.fragment,r),t=b(r),p(n.$$.fragment,r)},m(r,o){$(e,r,o),_(r,t,o),$(n,r,o),i=!0},p(r,o){const a={};o&68&&(a.$$scope={dirty:o,ctx:r}),e.$set(a);const f={};o&64&&(f.$$scope={dirty:o,ctx:r}),n.$set(f)},i(r){i||(h(e.$$.fragment,r),h(n.$$.fragment,r),i=!0)},o(r){d(e.$$.fragment,r),d(n.$$.fragment,r),i=!1},d(r){r&&x(t),m(e,r),m(n,r)}}}function De(s){let e,t;return e=new K({props:{$$slots:{default:[ze]},$$scope:{ctx:s}}}),{c(){c(e.$$.fragment)},l(n){p(e.$$.fragment,n)},m(n,i){$(e,n,i),t=!0},p(n,i){const r={};i&68&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(h(e.$$.fragment,n),t=!0)},o(n){d(e.$$.fragment,n),t=!1},d(n){m(e,n)}}}function Ve(s){let e,t,n,i;return e=new R({props:{size:"6",padded:!0,$$slots:{default:[Fe]},$$scope:{ctx:s}}}),n=new R({props:{size:"1",$$slots:{default:[De]},$$scope:{ctx:s}}}),{c(){c(e.$$.fragment),t=C(),c(n.$$.fragment)},l(r){p(e.$$.fragment,r),t=b(r),p(n.$$.fragment,r)},m(r,o){$(e,r,o),_(r,t,o),$(n,r,o),i=!0},p(r,o){const a={};o&65&&(a.$$scope={dirty:o,ctx:r}),e.$set(a);const f={};o&68&&(f.$$scope={dirty:o,ctx:r}),n.$set(f)},i(r){i||(h(e.$$.fragment,r),h(n.$$.fragment,r),i=!0)},o(r){d(e.$$.fragment,r),d(n.$$.fragment,r),i=!1},d(r){r&&x(t),m(e,r),m(n,r)}}}function Ye(s){let e,t;return e=new ue({props:{$$slots:{default:[Ve]},$$scope:{ctx:s}}}),{c(){c(e.$$.fragment)},l(n){p(e.$$.fragment,n)},m(n,i){$(e,n,i),t=!0},p(n,i){const r={};i&69&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(h(e.$$.fragment,n),t=!0)},o(n){d(e.$$.fragment,n),t=!1},d(n){m(e,n)}}}function Pe(s){let e,t,n;function i(o){s[5](o)}let r={};return s[1]!==void 0&&(r.consoleElement=s[1]),e=new pe({props:r}),L.push(()=>D(e,"consoleElement",i)),{c(){c(e.$$.fragment)},l(o){p(e.$$.fragment,o)},m(o,a){$(e,o,a),n=!0},p(o,a){const f={};!t&&a&2&&(t=!0,f.consoleElement=o[1],T(()=>t=!1)),e.$set(f)},i(o){n||(h(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){m(e,o)}}}function Me(s){let e,t,n,i;return e=new R({props:{size:"3",$$slots:{default:[Ye]},$$scope:{ctx:s}}}),n=new R({props:{size:"1",padded:!0,$$slots:{default:[Pe]},$$scope:{ctx:s}}}),{c(){c(e.$$.fragment),t=C(),c(n.$$.fragment)},l(r){p(e.$$.fragment,r),t=b(r),p(n.$$.fragment,r)},m(r,o){$(e,r,o),_(r,t,o),$(n,r,o),i=!0},p(r,o){const a={};o&69&&(a.$$scope={dirty:o,ctx:r}),e.$set(a);const f={};o&66&&(f.$$scope={dirty:o,ctx:r}),n.$set(f)},i(r){i||(h(e.$$.fragment,r),h(n.$$.fragment,r),i=!0)},o(r){d(e.$$.fragment,r),d(n.$$.fragment,r),i=!1},d(r){r&&x(t),m(e,r),m(n,r)}}}function Qe(s){let e,t,n,i,r,o;return e=new fe({}),n=new le({props:{title:"Foreach",$$slots:{default:[Se]},$$scope:{ctx:s}}}),r=new K({props:{$$slots:{default:[Me]},$$scope:{ctx:s}}}),{c(){c(e.$$.fragment),t=C(),c(n.$$.fragment),i=C(),c(r.$$.fragment)},l(a){p(e.$$.fragment,a),t=b(a),p(n.$$.fragment,a),i=b(a),p(r.$$.fragment,a)},m(a,f){$(e,a,f),_(a,t,f),$(n,a,f),_(a,i,f),$(r,a,f),o=!0},p(a,f){const g={};f&64&&(g.$$scope={dirty:f,ctx:a}),n.$set(g);const P={};f&71&&(P.$$scope={dirty:f,ctx:a}),r.$set(P)},i(a){o||(h(e.$$.fragment,a),h(n.$$.fragment,a),h(r.$$.fragment,a),o=!0)},o(a){d(e.$$.fragment,a),d(n.$$.fragment,a),d(r.$$.fragment,a),o=!1},d(a){a&&(x(t),x(i)),m(e,a),m(n,a),m(r,a)}}}function He(s){let e,t,n,i,r,o;return e=new oe({props:{title:"Foreach Language Interpreter",desc:"Interpreter for the Foreach programming language."}}),n=new ae({props:{$$slots:{default:[Qe]},$$scope:{ctx:s}}}),{c(){c(e.$$.fragment),t=C(),c(n.$$.fragment)},l(a){p(e.$$.fragment,a),t=b(a),p(n.$$.fragment,a)},m(a,f){$(e,a,f),_(a,t,f),$(n,a,f),i=!0,r||(o=[M(window,"beforeunload",Ie),M(window,"keydown",Ae)],r=!0)},p(a,[f]){const g={};f&71&&(g.$$scope={dirty:f,ctx:a}),n.$set(g)},i(a){i||(h(e.$$.fragment,a),h(n.$$.fragment,a),i=!0)},o(a){d(e.$$.fragment,a),d(n.$$.fragment,a),i=!1},d(a){a&&x(t),m(e,a),m(n,a),r=!1,ne(o)}}}function Ke(s,e,t){let n,i,r;function o(g){n=g,t(0,n)}function a(g){r=g,t(2,r)}function f(g){i=g,t(1,i)}return s.$$.update=()=>{s.$$.dirty&7&&(n&&Ce(n),i&&ye(i),r&&be(r))},[n,i,r,o,a,f]}class tt extends se{constructor(e){super(),re(this,e,Ke,He,te,{})}}export{tt as component};
